# FastMQ — ядро

**FastMQ** — это лёгкая асинхронная система обмена сообщениями поверх WebSockets, написанная на Python. Модуль предоставляет ядро для управления подключениями клиентов, маршрутизации сообщений и обработки фильтров.

## Компоненты

### Server
Запускает WebSocket-сервер на `0.0.0.0:25565`, обрабатывает новые подключения и перенаправляет сообщения между клиентами.

### Registry
Потокобезопасное хранилище для управления подключёнными клиентами:
- **Producer** — отправители сообщений (ID начиная с 100)
- **Consumer** — получатели сообщений (ID начиная с 0)

### ClientFabric
Фабрика для создания клиентов на основе пути подключения (`/producer` или `/consumer`).

### MessageHandler
Обработчик входящих сообщений в формате JSON. Перенаправляет сообщения всем Consumer, подписанным на указанные фильтры.

### FiltersManager
Управление системой фильтров:
- Добавление/удаление фильтров
- Подписка потребителей на фильтры
- Потокобезопасные операции

### Console
Интерактивная консоль для управления системой с поддержкой команд:
- `/add_filter [name]` — добавить фильтр
- `/remove_filter [name]` — удалить фильтр

## Формат сообщения
```json
{
  "filters": ["filter1", "filter2"],
  "message": "Текст сообщения"
}
```

## Подключение
- `ws://localhost:25565/producer` — для отправителей
- `ws://localhost:25565/consumer` — для получателей

## Логирование
Все события системы логируются в отдельные файлы для каждого модуля:
- `core.cli.log` — логи консоли управления
- `core.logger.log` — общие логи системы
- `core.managers.log` — логи менеджеров
- `core.source.log` — логи основного сервера

## Запуск
Основной модуль `main.py` инициализирует сервер и консоль управления. Для тестирования предусмотрены примеры подключения producer и consumer.