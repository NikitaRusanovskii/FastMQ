# FastMQ — ядро

FastMQ — это легковесная асинхронная система обмена сообщениями, построенная на основе WebSockets. Модуль предоставляет ядро для управления подключениями, маршрутизации сообщений и обработки жизненного цикла клиентов.

## Основные компоненты

### Сервер (`Server`)
- Запускает WebSocket-сервер на `0.0.0.0:25565` (конфигурируется через `config.ini`)
- Принимает подключения клиентов в ролях **Producer** или **Consumer**
- Обрабатывает сообщения в формате JSON

### Менеджеры
- **Registry** — потокобезопасное хранилище подключенных клиентов с уникальными ID
- **FiltersManager** — управление фильтрами и подписками потребителей
- **ClientFabric** — фабрика создания клиентов по ролям (`/producer` или `/consumer`)

### Обработчик сообщений (`MessageHandler`)
- Принимает сообщения от производителей в формате:
  ```json
  {
    "filters": ["filter_name"],
    "message": "Текст сообщения"
  }
- Перенаправляет сообщения всем потребителям, подписанным на указанные фильтры

### Консоль управления (`Console`)
- Интерактивный интерфейс для управления системой в реальном времени
- Поддерживает команды:
  - `/add_filter <name>` — добавление нового фильтра
  - `/remove_filter <name>` — удаление фильтра

## Подключение клиентов
- **Producer**: `ws://localhost:25565/producer`
- **Consumer**: `ws://localhost:25565/consumer`

## Логирование
Все события системы (подключения, сообщения, ошибки) записываются в файлы логов в директории `logs/` с использованием модуля `logging`.

## Конфигурация
Настройки сервера и идентификаторов хранятся в `config.ini`:
```ini
[SERVER_INFO]
server_ip = 0.0.0.0
server_port = 25565

[UNIT_INFO]
start_consumer_id = 0
start_producer_id = 100
```

## Тестирование
Реализованы модульные тесты для менеджера фильтров (`test_managers.py`) и интеграционный тест (`old_test_server.py`) для проверки взаимодействия компонентов.